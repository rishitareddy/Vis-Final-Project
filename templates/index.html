<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Final Project</title>
  <link rel="stylesheet" href="../static/main.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">

  <style>

  </style>
</head>

<body style="max-height: 100vh;">
  <div class="row" style="margin:0; width: 100%;justify-content: center;height: 8vh">
    <div class="col-8" style="display: flex;flex-direction: column;justify-content: center;">
      <h4 style ="text-align: center; margin:0;font-family: 'Open Sans Condensed', sans-serif;"> 
        <div style="display:inline-block;left:30px;position:absolute;top:0;">
          
          <div style="width:50%; " id="sparklines"></div>

        </div>POLICE FATALITY IN THE UNITED STATES OF AMERICA</h4>
        
    </div>
  </div>
  <!-- <div id="my_barchart"></div>  -->

  <!-- <div id="hdata"></div> -->
  <!-- <div id="horizontalbarchart"></div> -->
  <!-- <button onClick=reset() >RESET BUTTON!!!</button> -->
  <div style="position:relative ;">
 
    <!-- button styling -->
    <button class="button" onClick=reset() style="position: absolute;
    top: -30px;
    right: 30px;">Reset</button>

    <!-- choropleth styling -->
    <div id="vis" style="
    position: absolute;
    top: 80px;
    left: 20px;"></div>

    <!-- line chart styling -->
    <div style="position:absolute;left:400px;width: 375px;height:200px">
      <div style="padding-top: 30px;text-align: center;"><h6><b>Police violence is changing over time</b></h6></div>
      <div id="mylinechart" style="margin-top: -25px;"></div>
    </div>


    <!-- horizontal bar chart styling -->
    <div style="
    position: absolute;
    right: 65px;
    top: 30px;
    width: 300px;">
      <div style="width:100%;margin:auto"><h6 style="font-size:15px;text-align:center"><b>Which race of people are more likely to be killed by police violence?</b></h6></div>
      <div id="horizontalbarchart" ></div>
    </div>

    <!-- piechart styling -->
    <div style="
        position: absolute;
        top: 350px;
        left: 20px;
        width: 350px;
    "> 
      <div><h6 style="font-size:15px;text-align:center"><b>What weapon was the victim allegedly armed with?</b></h6></div>
      <div id="piechart" ></div>
    </div>

    <!-- PCP styling -->
    <div id="mypcp" style="position: absolute;left: 375px;top: 325px;width: 550px;height: 200px;"></div>
    <div style="position:absolute;
    height: 120px;
    right: 160px;
    top: 435px;
    width: 300px;">


    <!-- Stats styling -->
    <div style="position: absolute;top: -140px;width: 300px;left: 150px;">
    <h6 style="text-align: center"><b>Changed attribute :</b></h6> <p style= "text-align: center;margin-bottom: 0px;"id="variableName"></p>

    <p style= "text-align: center; top : 0 px"id="totalDeaths"></p>

    <p style= "text-align: center; margin-top: -15px !important; margin-left:70 px;"id="avoidableDeaths"></p>
    <!-- <p id="totalDeaths"></p>
    <p id="avoidableDeaths"></p> -->
  </div>

  <!-- Pictogram styling -->
  <div style="position: absolute;top:-10px;width: 300px;height: 300px;right: 0px;left: 150px;">
      <h6 style="text-align: center;margin-top:-25px"><b>There is no accountability</b></h6>
      <p><text style="font-size:2vw;color: #D74E43;">98.3%</text>of killings by police have not resulted in any charge.</p>
      <div style="position: absolute;top :70px;left:50px"
      id="grid-chart"></div>
    </div>
    <div id="stats" style="position: absolute;right: 0;bottom:0;display:flex;flex-direction: column;top:590px;right: 125px">
      
    </div>
    <!-- <div id="sparklines"></div> -->

  </div>
</div>

 <!-- <div style="display: flex;justify-content: center;">
    <div style="display:inline-block;">
      <div id="vis"></div>
    </div>
    <div style="display:inline-block;">
      <div id="horizontalbarchart"></div>
    </div>
    <div style="display:inline-block;"></div>
    <div id="mylinechart"></div>
    </div>
  </div>
  <div style="display: flex;justify-content: center;">
    <div style="display:inline-block;">
      <div id="mypcp"></div>
    </div>
    <div style="display:inline-block;">
      <div id="piechart"></div>
    </div>
    <div style="display:inline-block;">
    <div id='grid-container'>
        <div id='grid-chart'></div>
    </div>
    <div id='stats'>
        <p id="variableName"></p>
        <p id="totalDeaths"></p>
        <p id="avoidableDeaths"></p>
    </div>
  </div>
  </div> -->





<!-- Add 2 buttons -->
<!-- <button onclick="update(data1)">Data 1</button>
<button onclick="update(data2)">Data 2</button> -->

<br>

<!-- Create a div where the graph will take place -->

<!--
 <button onclick="updatebarchart('var1')">Variable 1</button>
<button onclick="updatebarchart('var2')">Variable 2</button>  -->


           <!-- <div id = "myscatterplot"></div>  -->



</body>





<!-- <script src="//d3js.org/d3.v3.min.js"></script> -->

 <!-- Color scale -->
 <!-- <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script> -->



<script src="https://d3js.org/d3.v4.js"></script>
<script src="//d3js.org/queue.v1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.13.0/d3-legend.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.min.js"></script>
<script src="//d3js.org/topojson.v1.min.js"></script>

 <!-- Color scale -->
 <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>


<script src="../static/choropleth.js"></script>
<script src="../static/d3-tip.js"></script>
 <script src="../static/h_barchart.js"></script>
<script src="../static/piechart.js"></script>
<script src ="../static/pictogram.js"></script>

<!-- <script src="../static/scatterplot.js"></script> -->

<!-- <script src="../static/v_barchart.js"></script>  -->
<!-- <script src="scatterplot.js"></script> -->
<script src="choropleth.js"></script>
<script src="../static/multi-linechart.js"></script>


<script src="../static/pcp.js"></script>
<!-- <script src="../static/index.js"></script> -->
<script src="../static/sparkline.js"></script>


<script>
  $(document).ready(function(){

    json_dictionary = {state : '', race: '', weapon : ''}


    var jqxhrGeography = $.ajax({
                      type: "POST",
                      contentType: "text/html;charset=utf-8",
                      url: "/get_geography_multiline",
                      traditional: "true",
                      data : JSON.stringify(json_dictionary),
                      dataType: "application/json",
                      async : false
                     }) ;
                     var responseGeography = {valid: jqxhrGeography.statusText,  data: jqxhrGeography.responseText};

                     var objGeography = JSON.parse(responseGeography.data)
                     console.log(objGeography.urban)
                     
                     drawSparkline(objGeography.urban, 9, 16,"urban")
                     drawSparkline(objGeography.rural, 2, 30,"rural")
                     drawSparkline(objGeography.suburban, 9, 13,"suburban")    
    
    reset()

    })


    function reset(){
      json_dictionary = {state : '', race: '', weapon : ''}
              var jqxhr = $.ajax({
                       type: "POST",
                       contentType: "text/html;charset=utf-8",
                       url: "/get_top_pd",
                       traditional: "true",
                       data : JSON.stringify(json_dictionary),
                       dataType: "application/json",
                       async : false
                      }) ;
                      var response = {valid: jqxhr.statusText,  data: jqxhr.responseText};

                      var obj = JSON.parse(response.data)
                      console.log(obj.multi)
                      drawMultiLineChart(obj)

                      hbarchart('All')
                      drawPieChart('All')

              var choro  = $.ajax({
                        type: "GET",
                        url: "/get_choro_data",
                        traditional: "true",
                        dataType: "string",
                        async : false,
                        success: function (data) {
                            drawChoropleth()
                            console.log(data, "Successful");
                        },error: function(error){
                          drawChoropleth()
                          console.log(error, "Unsuccessful");
                        }
                      }) ;
            console.log("Uncessful choro");


            var stats = $.ajax({
              type: "POST",
              contentType: "text/html;charset=utf-8",
              url: "/get_death_count",
              traditional: "true",
              data : JSON.stringify(json_dictionary),
              dataType: "application/json",
              async : false

             }) ;
             var statsResponse = {valid: stats.statusText,  data: stats.responseText};

             var obj = JSON.parse(statsResponse.data)
             document.getElementById("variableName").innerHTML="All killings from 2013 - 2021";

             document.getElementById("totalDeaths").innerHTML= 'Total deaths :' +obj.totalDeaths
             document.getElementById("avoidableDeaths").innerHTML= 'Avoidable deaths : ' +obj.avoidableDeaths

             pcp()


             
    }






</script>

</html>
